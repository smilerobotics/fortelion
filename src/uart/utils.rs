pub fn checksum(bytes: &[u8]) -> u8 {
    bytes.iter().copied().fold(0, |a, b| a ^ b)
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_checksum() {
        assert_eq!(checksum(&[0x00; 10]), 0x00);
        assert_eq!(checksum(&[0xff, 0xff]), 0x00);
        assert_eq!(checksum(&[0b01010101, 0b10101010]), 0b11111111);
        assert_eq!(checksum(&[0b01010101, 0b11111111]), 0b10101010);
        assert_eq!(checksum(&[0b10101010, 0b11111111]), 0b01010101);
        assert_eq!(
            checksum(&[0x77, 0xbb, 0xc1, 0x55, 0xdc, 0xe9, 0x04, 0x7d]),
            0x14
        );
        assert_eq!(
            checksum(&[
                0x9f, 0xea, 0x74, 0x8a, 0x21, 0xc2, 0xd6, 0x71, 0xde, 0x07, 0xe9, 0x2e, 0x18, 0x18,
                0x0d, 0xaa,
            ]),
            0x76
        );
        assert_eq!(
            checksum(&[
                0x3a, 0xf6, 0x25, 0x24, 0x2c, 0x6a, 0xa7, 0x8b, 0x4c, 0x21, 0xf1, 0x94, 0xc1, 0x9a,
                0xb9, 0x87, 0xba, 0x4a, 0x6f, 0xbe, 0x39, 0x01, 0x1c, 0x67, 0xbc, 0x7a, 0x71, 0xa6,
                0x19, 0xf8, 0xc7, 0xd5,
            ]),
            0x4a
        );
    }
}
